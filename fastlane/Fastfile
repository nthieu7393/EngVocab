# 1
ENV["FASTLANE_XCODEBUILD_SETTINGS_TIMEOUT"] = "600"
ENV['FASTLANE_APPLE_APPLICATION_SPECIFIC_PASSWORD']= 'eqmy-izsr-famb-agvb'

# 2
default_platform(:ios)
# 3
platform :ios do
  # 4
  lane :build do
    cert
    sigh
    gym
  end
  lane :test do
    scan
  end
  lane :alpha do
    # 1
    build
    # 2
    api_key = app_store_connect_api_key(
      key_id: "T2TM8TLBCV",
      issuer_id: "3bfff8be-a470-48b5-9d2f-7ed90a062e21",
      key_filepath: "./AuthKey_T2TM8TLBCV.p8",
      duration: 1200, # optional (maximum 1200)
      in_house: false # optional but may be required if using match/sigh
    )
    pilot(api_key: api_key)
    # 3
    increment_build_number
  end
  lane :release do
    # 1
    build
    # 2
    api_key = app_store_connect_api_key(
      key_id: "T2TM8TLBCV",
      issuer_id: "3bfff8be-a470-48b5-9d2f-7ed90a062e21",
      key_filepath: "./AuthKey_T2TM8TLBCV.p8",
      duration: 1200, # optional (maximum 1200)
      in_house: false # optional but may be required if using match/sigh
    )
    pilot(api_key: api_key)
    # 3
    increment_build_number
  end
end